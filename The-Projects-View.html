<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
  
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Description</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:ital@1&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=ADLaM+Display&family=Roboto+Condensed:ital@1&display=swap" rel="stylesheet">
<link href="path/to/font-awesome/css/all.min.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:opsz,wght@6..12,200&display=swap" rel="stylesheet">

   <style>
       
            *
            {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            .header{
                position: relative;
                top: 0;
                left: 0;
                width: 100%;
                padding: 1.5px 40px ;
                padding-right: 400px;
                background-color: #999;
                display: flex;
                justify-content: space-between;
                z-index: 100;
            }

            .logo{
                color: black;
                text-decoration: none;
                font-weight: 600;
                right: 40px;
                margin-right: 30px;
                font-size: 1.5rem;
            }


            .navbar a {
                font-size: 16px;
                color: black;
                text-decoration: none;
                font-weight: 400;

            }


            ul{
                list-style: none;
                
            }
            .menu1 > li ,.menu1 > a{
                display: inline-block;
            }
            
            .menu1 li{
                position: relative;
            }
            
            .menu1 a {
                text-decoration: none;
                color: white;
                display: block;
                padding: 10px 1.5rem;
                transition: background-color .22s ease, color .22s ease;
            }
            
           
            
            
            /*submenu1 level 1 styles*/
            
            .submenu1{
                position: absolute;
                background-color: gray;
                width: auto;
                left: 0;
                z-index: 100;
               padding-right: 10px; 
               display: none;
            }
          
            
            
            /*show menu1 on hover*/
            
            .menu1 li:hover> .submenu1 {
                display: block;
                animation: slideup .3s ease;
            
            }
           

            /*body styls*/

            .containerB {
                border: 1px solid;
                padding: 10px ;
                width:350px;
                margin: 20px;
                position: absolute;
            }
            

            .container button {
                text-align: left;
                margin: 10px;
                display: grid;
                justify-content: space-between;
                border: 2px solid black;
                border-radius: 10px;
                color: black;
                padding: 10px;
                width: auto;
                background: none;
                font-size: 18px;
                letter-spacing: 1px;
                cursor: pointer;
                position: relative;
                
            }

           
            
            /* Using a pseudo-element to create a background transition effect */
           
                    .container a
                    {
                        
                        font-size: medium;
                        color:black;
                        padding: 2px 1.5rem;
                        text-decoration: none;
                        
        
                        
                    }   
                    
            
            .containerB .sortbtn1{
                
                padding: 5px;
                font-size:larger;
                padding-left: 10px;
                border-radius: 10px;
                background: none;
                width: 60px ;
                cursor: pointer;


            }


            

            button#sort {
                position: absolute;
                left: 290px;
            }

          
          
 
            .containerB p {
                text-align: center;
                font-size: 20px;
                font-family: 'Nunito Sans', sans-serif; 
           }
            
            
            .search{
                position: relative;
                width: 60px;
                height: 35px;
                background: white;
                border-radius: 30px;
                transition: 0.5s;
                box-shadow: 0 0 0 2px gray;
                overflow: hidden;
                
                
                

            }

            .search.active{
                width: 360px;
            }
            .search .icon{
                position: absolute;
                top: 0;
                left: 0;
                width: 60px;
                height: 35px;
                background: white;
                border-radius: 60px;
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
                cursor: pointer;
                
            }
            .search .icon::before{
                content: "";
                position: absolute;
                width: 15px;
                height: 13px;
                border:3px solid blue;
                border-radius: 50%;
                transform: translate(-4px,-4px) ;


            }
            .search .icon::after{
                content: "";
                position: absolute;
                width: 3px;
                height: 12px;
                background:  black;
                border-radius: 50%;
                transform: translate(6px,6px) rotate(315deg);

            }
            
            .search .input{
                position: relative;
                width: 300px;
                height: 35px ;
                left: 60px;
                display: flex;
                justify-content: center;
                align-items: center;
            }


            .search .input input{
                position: absolute;
                top: 0;
                width: 100%;
                height: 100%;
                border: none;
                outline: none;
                font-size: 18px;
                padding: 10px 0;
            }


            .clear{
                position: absolute;
                top: 50%;
                transform: translateY(-50%);
                width: 15px;
                height: 15px;
                right: 15px;
                cursor: pointer;
                display: flex;
                justify-content: center;
                align-items: center;
                
            }

            .clear::before{
                content: "";
                position: absolute;
                width: 1px;
                height: 15px;
                background:#999;
                transform: rotate(45deg) ;
            }

            .clear::after{
                content: "";
                position: absolute;
                width: 1px;
                height: 15px;
                background:#999;
                transform: rotate(315deg) ;
            }


            
            



       /* ... Your existing styles ... */

/* Adjustments for responsive design */
@media (max-width: 2000px) {
    

    /* Adjust navigation styles as needed for medium screens */

   .navbar a {
    position: sticky;
   }

    button#sort {
        position: sticky;
    }
   

    
   
}





/* Adjustments for smaller screens */
@media (max-width: 768px) {
    

    /* Adjust navigation styles as needed for medium screens */
 

    button#sort {
        position: sticky;
    }
    

   

}

/* Additional media queries for even smaller screens if needed */
/* For example: @media (max-width: 480px) { ... } */









    
            
        </style>
    </head>
    <body>
        <header class="header"> 
            <a href="/The-Work-planing/index.html"  class="logo">TSA Work Planning</a>
               
             </a>
             <nav class="navbar">
                 <ul class="menu1">
                     <li><a href="/The-Work-planing/index.html">Home</a> </li>
                    <li><a href="#">Views</a><ul class="submenu1">
                        <li><a href="#">Work plan View</a></li>
                        <li> <a href="/The-Work-planing/The-Gantt.html">Resource Histogram</a></li>
                        <li><a href="#">Sales plan View</a></li>
                    </ul>  </li>
                    <li><a href="#">Work PLanning Data</a><ul class="submenu1">
    <li><a href="/The-Work-planing/The-Projects-View.html">Project Description</a></li>
    <li> <a href="#">Estimate Hours</a></li>
    <li><a href="#">Project Data Entry</a></li>
    <li><a href="#">Resource Allocation</a></li>
</ul>
</li>
                    <li><a href="#">User's Data Entry</a><ul class="submenu1">
                        <li><a href="#">DL Input Hours</a></li>
                        <li><a href="#">Project Progress</a></li>
                        <li><a href="#">User Availability</a></li>
                    </ul></li>
                    <li><a href="#">Admin</a>  <ul class="submenu1">
            <li> <a href="#">Access Permissions </a></li>
            <li> <a href="#">Role</a></li>
            <li> <a href="#">New Feature Popup</a></li>
            <li> <a href="#">Change Password</a></li>
            <li> <a href="#">Dashbored</a></li>
            <li> <a href="#">Logout</a></li>
   </ul></li>
   
                    
    
                </ul>
            </nav>
        </header>
       
       
  



    <div id = "sheetNamesContainerB" class="containerB">
        <div>
            <p>Available  Projects</p>
        </div >   
        <div class="btndiv"><button id="sort" class="sortbtn1">Sort</button></div>
        <div class="search" autocomplete="off">
            <div class="icon"></div>
            <div class="input">
                <input type="text" id="input" placeholder="Search ...">
                <ul class="list"></ul>
                
            </div><span class="clear"></span>
        </div>
        <div class="container">
       <ol id = "sheetNamesContainer" class="container">
          </ol>
    </div>
          
       </div> </div>


       




    <script src="https://apis.google.com/js/api.js"></script>

    <script>





      
        







































    var icon = document.querySelector('.icon')
    var search = document.querySelector('.search')
    icon.onclick = function(){
        search.classList.toggle('active')
    }



        gapi.load('client', initGoogleSheetsAPI);

        function initGoogleSheetsAPI() {
            gapi.client.init({
                apiKey: 'AIzaSyC1YBfz6znLEessxTPGSZjIJtM1CRAPZ24',
                discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
            }).then(fetchSheetNames).catch(function (error) {
                console.log('Error initializing Google Sheets API: ' + error.details);
            });
        }
        
        function formatDate(date) {
            const day = date.getDate();
            const month = date.toLocaleString('default', { month: 'short' }); // Get abbreviated month name
            return `${day}-${month}`;
        }
        
        function fetchSheetNames() {
            sheetTitles = []
            console.log(sheetTitles)



    
            var input =document.getElementById("input")
            input.addEventListener("keyup",(e) =>{
                for (var i of sheetTitles){
                    if(
                        i.toLowerCase().startsWith(input.value.toLowerCase()) &&
                        input.value != ""
                    ){
                        var listItem = document.createElement("li")
                        listItem.classList.add("list-items");
                        listItem.style.cursor="pointer";
                        //listItem.setAttribute("onclick","displayNames('" +i+ "')");

                        var word = "<b>" + i.substr(input.value.length) + "<b>"
                        word += i.substr(input.value.length)
                       console.log (word)
                       

                    }
                }
                     
   }) 

            function displayNames(value){
                input.value = value
            }

        



            gapi.client.sheets.spreadsheets.get({
                spreadsheetId: '1BQyLzI0v6RwX1cZ_u-nsli9KPIgJNFCH62t3kMeJuhA',
            }).then(async function (response) {
                var sheets = response.result.sheets;
                if (sheets && sheets.length > 0) {
                    var container = document.getElementById('sheetNamesContainer'); // Replace with your container element ID
                    for (var i = 0; i < sheets.length; i++) {
                        var sheetTitle = sheets[i].properties.title;
                        var sheetId = sheets[i].properties.sheetId;
                        var sheetUrl = 'https://docs.google.com/spreadsheets/d/' + response.result.spreadsheetId + '/edit#gid=' + sheetId;
                        
                        // Skip specific sheets by title
                        if (
                            sheetTitle === "Employees Report" ||
                            sheetTitle === "AVAILABILITY SHEET" ||
                            sheetTitle === "Employees Allocation" ||
                            sheetTitle === "Reports" ||
                            sheetTitle === "Tasks' Source" ||
                            sheetTitle === "Employee Availability"
                        ) {
                            continue;
                        }
                        sheetTitles.push(sheetTitle)
        
                        var sheetElement = document.createElement('button');
                        var linkElement = document.createElement('a');
        
                        linkElement.href = sheetUrl;
                        
        
                        sheetElement.appendChild(linkElement);
                        container.appendChild(sheetElement);
        
                        // Fetch and display start and end dates
                        try {
                            const dates = await fetchDatesFromSheet(sheetTitle);
                            linkElement.textContent = sheetTitle/* +  ` (${formatDate(dates.firstStartDate)} - ${formatDate(dates.lastEndDate)})`;*/
                        } catch (error) {
                            console.log('Error fetching dates from sheet: ', error.details);
                        }
        
                        sheetElement.addEventListener('click', function () {
                            window.location.href = sheetUrl;
                        });
                    }
                } else {
                    console.log('No sheets found in the spreadsheet.');
                }
            }).catch(function (error) {
                console.log('Error fetching sheet names: ' + error.details);
            });
        }
        
        async function fetchDatesFromSheet(sheetTitle) {
            try {
                const response = await gapi.client.sheets.spreadsheets.values.get({
                    spreadsheetId: '1BQyLzI0v6RwX1cZ_u-nsli9KPIgJNFCH62t3kMeJuhA',
                    range: sheetTitle + '!I2:J', // Adjust the range based on your data location
                });
        
                const values = response.result.values;
                let firstStartDate = null;
                let lastEndDate = null;
        
                for (let i = 0; i < values.length; i++) {
                    const startDate = new Date(values[i][0]);
                    const endDate = new Date(values[i][1]);
        
                    if (!isNaN(startDate) && (firstStartDate === null || startDate < firstStartDate)) {
                        firstStartDate = startDate;
                    }
        
                    if (!isNaN(endDate) && (lastEndDate === null || endDate > lastEndDate)) {
                        lastEndDate = endDate;
                    }
                }
        
                return { firstStartDate, lastEndDate };
            } catch (error) {
                console.log('Error fetching dates from sheet: ', error.details);
                throw error; // Propagate the error to the caller
            }
        }
        

        
  
    
    var sortButton = document.getElementById('sort');
    sortButton.addEventListener('click', function() {
        var container = document.getElementById('sheetNamesContainer');
        var sortedSheetElements = Array.from(container.children).sort((a, b) => {
            var titleA = a.textContent.trim().toLowerCase();
            var titleB = b.textContent.trim().toLowerCase();
            return titleA.localeCompare(titleB);
        });
        for (var i = 0; i < sortedSheetElements.length; i++) {
            
            container.appendChild(sortedSheetElements[i]);
        }
    });
    
    </script>
</body>
</html>
